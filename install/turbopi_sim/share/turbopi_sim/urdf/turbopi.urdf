<?xml version="1.0"?>
<robot name="turbopi">

  <!-- constants resolved to numbers -->
  <!-- base: 0.20 x 0.15 x 0.05 m -->
  <!-- wheel radius: 0.03 m, width: 0.02 m -->
  <!-- wheelbase: 0.12 m, separation: 0.10 m -->

  <link name="base_link">
    <inertial>
      <origin xyz="0 0 0.025" rpy="0 0 0"/>
      <mass value="1.2"/>
      <inertia ixx="0.004" iyy="0.006" izz="0.007" ixy="0.0" ixz="0.0" iyz="0.0"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0.025" rpy="0 0 0"/>
      <geometry>
        <box size="0.20 0.15 0.05"/>
      </geometry>
      <material name="gray">
        <color rgba="0.6 0.6 0.6 1.0"/>
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0.025" rpy="0 0 0"/>
      <geometry>
        <box size="0.20 0.15 0.05"/>
      </geometry>
    </collision>
  </link>

  <!-- wheel template expanded with numbers -->

  <!-- front-left -->
  <link name="fl_wheel">
    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <mass value="0.05"/>
      <inertia ixx="0.0001" iyy="0.0001" izz="0.0001" ixy="0" ixz="0" iyz="0"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry><cylinder radius="0.03" length="0.02"/></geometry>
      <material name="black"><color rgba="0.05 0.05 0.05 1.0"/></material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry><cylinder radius="0.03" length="0.02"/></geometry>
    </collision>
  </link>
  <joint name="fl_wheel_joint" type="continuous">
    <parent link="base_link"/>
    <child  link="fl_wheel"/>
    <origin xyz="0.06 0.05 0.03" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <limit effort="1.0" velocity="50.0"/>
    <dynamics damping="0.1" friction="0.05"/>
  </joint>

  <!-- front-right -->
  <link name="fr_wheel">
    <inertial><origin xyz="0 0 0"/><mass value="0.05"/>
      <inertia ixx="0.0001" iyy="0.0001" izz="0.0001" ixy="0" ixz="0" iyz="0"/></inertial>
    <visual><origin xyz="0 0 0"/><geometry><cylinder radius="0.03" length="0.02"/></geometry></visual>
    <collision><origin xyz="0 0 0"/><geometry><cylinder radius="0.03" length="0.02"/></geometry></collision>
  </link>
  <joint name="fr_wheel_joint" type="continuous">
    <parent link="base_link"/>
    <child  link="fr_wheel"/>
    <origin xyz="0.06 -0.05 0.03" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <limit effort="1.0" velocity="50.0"/>
    <dynamics damping="0.1" friction="0.05"/>
  </joint>

  <!-- back-left -->
  <link name="bl_wheel">
    <inertial><origin xyz="0 0 0"/><mass value="0.05"/>
      <inertia ixx="0.0001" iyy="0.0001" izz="0.0001" ixy="0" ixz="0" iyz="0"/></inertial>
    <visual><origin xyz="0 0 0"/><geometry><cylinder radius="0.03" length="0.02"/></geometry></visual>
    <collision><origin xyz="0 0 0"/><geometry><cylinder radius="0.03" length="0.02"/></geometry></collision>
  </link>
  <joint name="bl_wheel_joint" type="continuous">
    <parent link="base_link"/>
    <child  link="bl_wheel"/>
    <origin xyz="-0.06 0.05 0.03" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <limit effort="1.0" velocity="50.0"/>
    <dynamics damping="0.1" friction="0.05"/>
  </joint>

  <!-- back-right -->
  <link name="br_wheel">
    <inertial><origin xyz="0 0 0"/><mass value="0.05"/>
      <inertia ixx="0.0001" iyy="0.0001" izz="0.0001" ixy="0" ixz="0" iyz="0"/></inertial>
    <visual><origin xyz="0 0 0"/><geometry><cylinder radius="0.03" length="0.02"/></geometry></visual>
    <collision><origin xyz="0 0 0"/><geometry><cylinder radius="0.03" length="0.02"/></geometry></collision>
  </link>
  <joint name="br_wheel_joint" type="continuous">
    <parent link="base_link"/>
    <child  link="br_wheel"/>
    <origin xyz="-0.06 -0.05 0.03" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <limit effort="1.0" velocity="50.0"/>
    <dynamics damping="0.1" friction="0.05"/>
  </joint>

  <!-- Gazebo MecanumDrive plugin -->
  <gazebo>
    <plugin filename="gz-sim-mecanum-drive-system" name="gz::sim::systems::MecanumDrive">
      <front_left_joint>fl_wheel_joint</front_left_joint>
      <front_right_joint>fr_wheel_joint</front_right_joint>
      <back_left_joint>bl_wheel_joint</back_left_joint>
      <back_right_joint>br_wheel_joint</back_right_joint>
      <wheelbase>0.12</wheelbase>
      <wheel_separation>0.10</wheel_separation>
      <wheel_radius>0.03</wheel_radius>
      <odom_publish_frequency>30</odom_publish_frequency>
      <topic>/model/turbopi/cmd_vel</topic>
    </plugin>
  </gazebo>

</robot>
